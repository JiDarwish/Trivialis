# Meedle Backend

## Setup
You will probably have to nuke (drop all tables, including `alembic_version`) your database (you can do this by deleting docker volumes and data completely) if
you have been working on this project before.

## Migrations

To create a new autogenerated migration, run this:
```bash
docker-compose exec backend alembic revision --autogenerate -m "MESSAGE HERE"
```
This will autogenerate your database migrations - you should check the code, modify it and commit it.
[Alembic's official documentation](https://alembic.sqlalchemy.org/en/latest/tutorial.html#create-a-migration-script).

Migrations are run using alembic. To run all migrations:
```bash
docker-compose run --rm backend alembic upgrade head
```


## Testing

There is a helper script for both frontend and backend tests:

```bash
./scripts/test.sh
```

## Populating the database
Populate superuser
```bash
docker-compose run --rm backend python app/initial_data.py
```

Populate starter plan and package
```bash
docker-compose run --rm backend python app/initial_data.py populate
```

### Backend Tests

```bash
docker-compose run backend pytest
```

any arguments to pytest can also be passed after this command